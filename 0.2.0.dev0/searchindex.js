Search.setIndex({docnames:["agent","distributed","examples","index","kubernetes","metrics","quickstart","rendezvous","runtime","timer","train_script"],envversion:{"sphinx.domains.c":1,"sphinx.domains.changeset":1,"sphinx.domains.cpp":1,"sphinx.domains.javascript":1,"sphinx.domains.math":2,"sphinx.domains.python":1,"sphinx.domains.rst":1,"sphinx.domains.std":1,"sphinx.ext.intersphinx":1,"sphinx.ext.todo":1,"sphinx.ext.viewcode":1,sphinx:55},filenames:["agent.rst","distributed.rst","examples.rst","index.rst","kubernetes.rst","metrics.rst","quickstart.rst","rendezvous.rst","runtime.rst","timer.rst","train_script.rst"],objects:{"torchelastic.agent":{server:[0,0,0,"-"]},"torchelastic.agent.server":{ElasticAgent:[0,1,1,""],SimpleElasticAgent:[0,1,1,""],Worker:[0,1,1,""],WorkerGroup:[0,1,1,""],WorkerSpec:[0,1,1,""],WorkerState:[0,1,1,""]},"torchelastic.agent.server.ElasticAgent":{get_worker_group:[0,2,1,""],run:[0,2,1,""]},"torchelastic.agent.server.SimpleElasticAgent":{_initialize_workers:[0,2,1,""],_monitor_workers:[0,2,1,""],_rendezvous:[0,2,1,""],_restart_workers:[0,2,1,""],_start_workers:[0,2,1,""],_stop_workers:[0,2,1,""],get_worker_group:[0,2,1,""],run:[0,2,1,""]},"torchelastic.agent.server.api":{MonitorResult:[0,1,1,""]},"torchelastic.agent.server.local_elastic_agent":{LocalElasticAgent:[0,1,1,""]},"torchelastic.distributed":{launch:[1,0,0,"-"]},"torchelastic.metrics":{configure:[5,3,1,""],prof:[5,3,1,""],put_metric:[5,3,1,""]},"torchelastic.metrics.api":{ConsoleMetricHandler:[5,1,1,""],MetricHandler:[5,1,1,""],NullMetricHandler:[5,1,1,""]},"torchelastic.rendezvous":{RendezvousClosedException:[7,1,1,""],RendezvousHandler:[7,1,1,""],RendezvousNonRetryableError:[7,1,1,""],RendezvousTimeoutException:[7,1,1,""]},"torchelastic.rendezvous.RendezvousHandler":{is_closed:[7,2,1,""],next_rendezvous:[7,2,1,""],num_nodes_waiting:[7,2,1,""],set_closed:[7,2,1,""]},"torchelastic.rendezvous.etcd_rendezvous":{EtcdRendezvous:[7,1,1,""],EtcdRendezvousHandler:[7,1,1,""],EtcdStore:[7,1,1,""]},"torchelastic.rendezvous.etcd_rendezvous.EtcdRendezvous":{announce_self_waiting:[7,2,1,""],confirm_membership:[7,2,1,""],confirm_phase:[7,2,1,""],handle_existing_rendezvous:[7,2,1,""],handle_join_last_call:[7,2,1,""],init_phase:[7,2,1,""],join_phase:[7,2,1,""],join_rendezvous:[7,2,1,""],rendezvous_barrier:[7,2,1,""],set_closed:[7,2,1,""],try_create_rendezvous:[7,2,1,""],wait_for_final:[7,2,1,""],wait_for_peers:[7,2,1,""],wait_for_rendezvous_to_free:[7,2,1,""]},"torchelastic.rendezvous.etcd_rendezvous.EtcdStore":{add:[7,2,1,""],check:[7,2,1,""],get:[7,2,1,""],set:[7,2,1,""],set_timeout:[7,2,1,""],wait:[7,2,1,""]},"torchelastic.rendezvous.etcd_server":{EtcdServer:[7,1,1,""]},"torchelastic.timer":{LocalTimerClient:[9,1,1,""],LocalTimerServer:[9,1,1,""],TimerClient:[9,1,1,""],TimerRequest:[9,1,1,""],TimerServer:[9,1,1,""],configure:[9,3,1,""],expires:[9,3,1,""]},"torchelastic.timer.TimerClient":{acquire:[9,2,1,""],release:[9,2,1,""]},"torchelastic.timer.TimerServer":{clear_timers:[9,2,1,""],get_expired_timers:[9,2,1,""],register_timers:[9,2,1,""]},torchelastic:{agent:[0,0,0,"-"],distributed:[1,0,0,"-"],metrics:[5,0,0,"-"],rendezvous:[7,0,0,"-"],timer:[9,0,0,"-"]}},objnames:{"0":["py","module","Python module"],"1":["py","class","Python class"],"2":["py","method","Python method"],"3":["py","function","Python function"]},objtypes:{"0":"py:module","1":"py:class","2":"py:method","3":"py:function"},terms:{"0rc":8,"0rc0":2,"30s":7,"600s":7,"abstract":0,"byte":7,"case":[2,3,7,9,10],"class":[0,5,7,9],"default":[0,2,5,7],"export":[2,10],"final":[0,7],"float":9,"function":[0,1,5,7],"import":[1,5,9],"int":[0,5,7],"long":7,"new":[0,1,7],"null":5,"return":[0,7,9],"short":7,"true":9,"try":[0,5,7],"var":[7,10],"void":0,"while":[0,7],AWS:3,For:[0,1,2,5,7,10],NOT:[0,1,7,9],ONE:6,Such:7,That:[0,1],The:[0,1,2,5,7,8,9],There:7,Use:[0,3,7],Used:[1,7],Useful:7,Uses:7,Using:5,_initialize_work:0,_monitor_work:0,_rendezv:0,_restart_work:0,_start_work:0,_stop_work:0,abl:7,about:[0,1,5,6],abov:[7,9],accord:0,accordingli:0,acquir:9,acquisit:9,across:0,action:0,activ:9,actual:0,add:[5,7],added:5,adding:5,addit:[1,7],admit:[1,7],advanc:0,advertis:6,after:[7,9],agent:[1,3,5,6,9],agre:7,aliv:7,all:[0,1,2,5,6,7,9,10],all_reduc:9,alloc:7,allow:[0,1,7],alreadi:7,also:[5,7],altern:2,alwai:9,amount:7,ani:[0,1,3,7,9],announc:7,announce_self_wait:7,api:[0,1,2,3,5,6,7,9],appli:[0,1],appropri:2,approxim:7,arch:2,arg1:[1,6],arg:[0,1,6,9,10],argument:[0,1,10],argv:10,arriv:[1,7],assgin:1,assign:[0,1,7],assum:[0,1,7],assumpt:[1,5],atom:7,attempt:[1,7],automat:[1,7],avail:[0,1,2,7],awai:3,back:7,backend:[1,7,10],bar:5,barrier:7,base:[0,3,7],basecontext:9,basic:7,batch:[1,2,10],baz:5,becaus:7,becom:7,been:[7,10],befor:[1,2,5,7,9],begin:7,behavior:1,being:[0,7,9],belong:5,below:[0,2,5,7,8,9,10],best:7,better:0,between:[1,2,7,9],bin:7,binari:7,block:[7,9],blueprint:0,bool:[7,9],both:[0,1,7],box:[1,2],built:2,c10:7,c10d:[1,7],calcul:5,calculate_lat:5,call:[0,7,9],caller:[0,7],can:[0,1,2,3,5,7,9],capac:3,caus:7,certain:5,chang:[0,1,3,7],check:[0,7],checkpoint:[1,10],checkpoint_path:[1,10],class_nam:5,classif:2,classnam:5,classy_train:2,classy_vis:2,clear:9,clear_tim:9,client:[6,7],close:7,cloud:3,cluster:[1,7,8],code:[1,9],collect:[0,7],combin:7,come:[5,7],command:[1,2],common:7,commun:[0,7,9],compat:0,complet:[0,7,9],compliant:10,compris:1,conclud:7,concret:10,config:2,config_fil:2,configur:[0,1,5,7,9],confirm:7,confirm_membership:7,confirm_phas:7,connect:7,consid:[0,7],consist:[1,7],consol:5,consolemetrichandl:5,consolemetricshandl:5,contain:[0,1],context:[0,1,7,9],continu:10,contrast:0,control:[0,2,4,7,8],conveni:[5,7],coordin:0,copi:0,correl:1,could:[0,7],count:5,countdown:9,counter:7,crash:7,creat:[0,1,2,7],critic:[3,7],cross:0,cumbersom:7,current:[1,7],custom:[2,4,5,6],daemon:9,data:[0,2,5,7,9],dataset:[1,10],datetim:7,deadlin:[7,9],deal:[0,9],debug:5,decentr:0,decid:7,decis:[0,7,9],decor:5,def:[0,1,5,9,10],def_nam:5,defens:0,defin:[0,1],definit:[1,4],delai:7,deleg:0,demand:3,demonstr:2,departur:1,depend:[0,1,2,9],deploi:[0,2,7],deploy:[0,1,7],deprec:3,describ:[0,7],descript:7,design:[3,5,7],destin:5,destroi:7,detect:[0,7],dev:5,devic:[2,9],diagram:[0,7],dict:[0,9],did:[0,7],differ:[1,2,5,7,10],directli:[0,6],discoveri:7,dist:1,distribut:[0,1,3,6,7,9,10],doc:7,docker:2,dockerfil:2,doe:[0,2,5,6,7,9],doing:7,doubl:0,down:[0,1],due:[1,3,7],durat:[5,7],dure:[0,7],dynam:3,each:[0,1,2,9,10],easi:7,effect:9,either:[2,3,7,9],elast:[2,3,4,6,8,10],elasticag:0,elig:9,els:7,emit:5,empti:[0,7],enabl:[1,3,6],encod:[0,5],encourag:[0,8],end:[2,5],endpoint:[1,7],enough:2,ensur:[7,10],entir:[0,1,2],entiti:9,entri:[1,7],env:[7,10],environ:[0,1,7,10],epoch:[2,10],equal:[1,7,9],error:[0,7],essenti:0,etc:[0,7],etcd:[1,2,6,10],etcd_address:7,etcd_binary_path:7,etcd_client:7,etcd_host:[1,6],etcd_port:[1,6],etcd_prefix:7,etcd_rendezv:7,etcd_serv:7,etcd_store_prefix:7,etcdrendezv:[1,7],etcdrendezvoushandl:7,etcdrendezvousretryablefailur:7,etcdserv:7,etcdstor:7,even:0,event:0,eventu:7,everi:7,everyon:[0,7],exact:[0,9],exactli:9,exampl:[0,3,5,7,9,10],except:[0,5],exchang:7,exclud:7,exclus:7,execut:3,exist:[0,1,7],exit:[0,7],expect:[0,7,9],expected_vers:7,experiment:7,expir:[3,7],expiration_tim:9,expiri:9,expositori:10,extend:9,fail:[0,1,7,10],failur:[0,1,2,3,5,7,10],fallback:7,far:1,fashion:9,fault:[0,1,3,6,7],few:0,field:[0,5],file:7,find:7,finish:[0,5,7,9],first:[0,5,7],fix:[1,7],flag:[2,10],flaki:3,follow:[0,1,2,5,6,7],foo:5,foobar:5,form:[1,7],format:1,fqdn:1,framework:[2,5],free:7,frequenc:1,frequent:3,fresh:0,from:[0,2,5,7,9,10],frozen:7,full:[7,10],futur:[0,7],gang:1,gather:7,get:[1,3,7,9,10],get_client:7,get_context:[0,9],get_expired_tim:9,get_worker_except:0,get_worker_group:0,github:[4,8],given:[0,7,9],global:[0,1],global_rank:0,gloo:1,goal:5,gpu:[0,2,9],gracefulli:[0,1,7],grade:3,greater:7,group:[0,1,5,7,9,10],group_nam:5,group_rank:1,groupchang:0,groupcontain:0,groupfail:0,guarante:[7,9],handl:[0,1,7],handle_existing_rendezv:7,handle_join_last_cal:7,handler:2,happen:[0,7],hard:1,hardwar:3,has:[5,7,9,10],have:[0,1,2,5,7,9,10],healthi:[0,7],help:[2,5,7],helper:7,henc:[0,7,10],here:[6,7],high:[0,2,5],highli:[2,7,8],hold:[0,9],holder:0,homogen:[0,1],host:[0,1,6,9],how:[2,7,9],howev:[0,5],html:6,http:6,identifi:[0,1,5,9],imag:2,immedi:[1,7],implement:[1,2,5,7],implementor:0,impli:7,impos:9,includ:[5,7],incom:9,increas:5,increment:7,independ:7,indic:7,inform:[0,2,4,7],infrastructur:3,ing:7,init:0,init_phas:7,init_process_group:[0,1,10],initi:[0,1,7,10],insid:7,instal:6,instanc:[0,1,2,3,5,7,9],instead:[0,2,5,7],instruct:[2,8,9],integ:7,intend:7,intent:7,inter:0,interfac:[5,7],intermedi:7,intern:5,interpret:[0,7,9],interrup:0,interrupt:0,invalid:7,invok:1,is_clos:7,item:1,iter:[1,10],its:[7,9],job:[0,1,2,3,4,5,6,7,8,9],job_id:[1,6,7],join:[1,7],join_phas:7,join_rendezv:7,joinabl:7,json:2,just:0,keep:7,keep_al:7,kei:[1,7],kill:[1,9],kubernet:[2,3,8],kwarg:7,larg:2,last:7,last_call_timeout:7,late:7,latenc:5,later:7,launch:[0,2,3,6,7,10],launcher:2,leaf:5,leaf_modul:5,learn:6,leas:[3,7],least:[2,6,7],leav:[0,1],less:9,level:[0,2,5],librari:9,like:7,list:[7,9],listen:6,load_checkpoint:[1,10],loader:2,local:[0,1,7,9,10],local_elastic_ag:0,local_rank:[0,1,10],local_world_s:[0,1],localelasticag:[0,9],localhost:7,localtimercli:9,localtimerserv:9,localworkergroup:1,locat:5,log:[0,5],logic:10,longer:9,look:[6,7],lookuperror:7,lose:[7,10],lost:[0,1,10],machin:0,made:1,mai:[0,5,6,7],main:[0,1,2,7,9,10],make:[0,1,5,7,9,10],manag:[0,1,3,9],manger:7,mani:7,manner:3,manual:[1,7,10],map:[0,1,5],mark:7,master_addr:[1,10],master_port:[1,10],match:7,max:[1,7],max_interv:9,max_nnod:1,max_nod:2,max_restart:[0,1],max_siz:[1,6],max_work:7,maximum:7,mean:[7,9],meant:[7,9],measur:5,mechan:7,meet:[2,6],member:[0,1,7],membership:[0,1,7],messag:9,message_queu:9,method:[0,7],metric:3,metric_data:5,metric_group:5,metric_group_nam:5,metric_nam:5,metric_valu:5,metrichandl:5,might:7,millisecond:5,min:[1,7],min_nod:2,min_siz:[1,6],min_work:7,minimum:7,mission:3,mode:[1,7],model:10,modul:[1,5,7],monitor:[0,1,7,9],monitorresult:0,more:[0,2,4,6,7,9],most:[0,6,7,9,10],mp_queue:9,multi:[0,1,7],multipl:[2,7,9],multiprocess:[0,9],must:[0,1,2,9,10],mutabl:0,my_app:5,my_method:5,my_metr:5,my_modul:5,name:5,nccl:1,necessari:[0,1,7],necessarili:7,need:[1,3,7,10],neg:9,ness:1,network:7,never:[1,7],next:7,next_rendezv:7,nnode:[1,2,6],node:[0,1,3,6,7],non:[0,7,9],none:[0,5,7,9],noqa:7,normal:7,note:[0,1,7,9],notic:1,notifi:1,now:[5,9,10],nproc_per_nod:[1,2,6],nproc_per_process:0,nullmetrichandl:5,nullmetricshandl:5,num:7,num_cuda_devic:2,num_max_work:7,num_min_work:7,num_nod:[1,6],num_nodes_wait:7,num_train:1,num_workers_wait:7,number:[0,1,2,7],nvidia:2,object:[0,7,9],observ:[0,7],occupi:2,occur:7,off:0,onc:7,one:[0,2,5,7,9,10],onli:[0,1,2,7,8],oom:2,oper:[5,7],opportun:7,optimist:0,option:[2,7,10],other:[0,5,7],other_param:[0,9],otherwis:7,our:[1,2,4,6,8,10],ourselv:7,out:[1,2,5],output:[0,5],overal:7,override_timeout:7,overview:5,own:[2,7,9],p2p:7,page:[2,10],pair:[7,9],parallel:7,paramet:[0,7],parent:9,pars:10,parse_arg:10,part:7,partial:[0,7],particip:[1,7],particular:[0,1,5,7],particularli:9,pass:[0,1,2,5,7,9,10],path:[7,10],peer:7,per:[0,1,7,9],perform:7,period:7,persist:7,phase:7,physic:1,pid:[0,9],piggyback:7,pip:6,place:[0,7],placement:0,plane:[0,7],platform:5,pleas:[2,4,7],plugin:3,point:[1,2,5,7],pool:3,port:[0,1,7],possibl:7,potenti:[7,9],power:6,prefer:[0,8],prefix:7,present:7,previous:7,primit:7,print:5,prior:0,problem:7,process:[0,1,2,7,9,10],prod:5,produc:5,product:[2,3,7],prof:5,profil:5,program:10,progress:[0,1,10],propag:7,properli:[0,7],properti:5,protocol:9,provid:[0,1,3,7,9,10],public_hostnam:6,publish:[5,7],put:0,put_metr:5,python:[0,1,5,6,7],pytorch:[0,2,3],quad:0,qualifi:5,queri:7,queue:[0,9],quickli:7,quickstart:3,rais:[0,7],random:7,rang:[1,7,10],rank:[0,1,7,10],rather:9,ratio:0,rdzv:[0,1],rdzv_backend:[1,2,6,10],rdzv_endpoint:[1,2,6,10],rdzv_id:[1,2,6],rdzv_impl:7,rdzv_version:7,reach:[0,7],react:0,read:0,readm:[2,4,8],reap:9,recent:10,recommend:[0,1,2,7],recov:0,refer:[4,7,8],region:5,regist:[7,9],register_tim:9,regular:0,relat:0,relationship:5,releas:[7,9],relev:0,remain:7,remot:0,remov:[2,10],render:7,rendev:1,rendezv:[0,1,2,3,5,10],rendezvous_barri:7,rendezvousclosedexcept:7,rendezvoushandl:[1,7],rendezvousnonretryableerror:7,rendezvoustimeoutexcept:7,renew:7,replac:[1,3],repres:[0,7,9],request:9,request_queu:9,requestqueu:9,requir:[0,2,6],reserv:5,resili:3,resnet18:2,resourc:[4,7],respons:[0,5,7,9],restart:[0,1,10],result:[0,1],resum:7,ret_val:0,retri:[0,7,9],retryabl:7,role:[0,1,7],root:7,run:[0,1,2,3,6,7,8,9],run_id:7,safe:7,same:[0,1,2,5,7,9,10],save_checkpoint:[1,10],scaffold:0,scale:1,scenario:7,schedul:0,scheme:7,scope:9,scope_id:9,script:[0,1,2,3,6,9],second:9,section:[0,1,8],see:[2,7,10],self:[0,5,9],semant:[1,7],sens:7,sensibl:5,separ:[2,7],server:[1,2,6],set:[0,2,7,9,10],set_clos:7,set_timeout:7,setup:[1,2,7,8],share:[1,2,3,7],shared_queu:0,shm:2,should:[0,1,2,7,9],should_checkpoint:1,shutdown:7,side:[7,9],sidecar:[1,2,7],signal:7,signatur:0,similar:[1,2,5],simpl:7,simpleelasticag:0,simplest:0,simpli:[1,2],sinc:9,singl:[0,1,2,6,7],sink:5,situat:9,size:[0,1,2,3,7],small:7,some:[0,1,7,9],someon:7,soon:7,sourc:[0,5,7,9],spawn:[0,9],spec:[0,9],specif:[0,7,9],specifi:[0,1,2,7],spot:3,stabl:[1,7],stage:5,standalon:7,start:[0,1,2,3,5,6,7,9],start_method:[0,9],start_work:0,state:[0,7,10],stdout:5,stdoutmetrichandl:5,still:7,stop:[0,1,7],store:[0,1,7],str:[0,5,7,9],string:[0,5,7],strongli:1,structur:[0,1],stuck:[0,9],style:1,subprocess:[7,9],subset:1,substitut:[2,7],succe:7,succeed:0,success:5,successfulli:[0,5,7],succinctli:5,suffici:7,support:[1,3],sure:[1,10],surviv:1,synchron:7,sys:10,take:[6,7,9],taken:3,talk:9,tcp:1,tear:0,technic:7,telemetri:5,template_config:2,temporarili:0,term:7,termin:[0,7,9],test:[1,7],than:[1,5,7,9],thei:7,them:[5,7,9],themselv:7,thi:[0,1,2,7,9,10],this_rank:7,thought:5,thread:0,threw:5,throughout:2,time:[3,5,7,9],timedelta:7,timefram:9,timeout:7,timer:3,timer_cli:9,timer_request:9,timercli:9,timerrequest:9,timerserv:9,timeseri:5,timestamp:5,tini:2,tmp:7,toi:5,toler:[0,1,3,6,7],too:7,toolkit:2,topolog:0,torch:[0,1,7,9,10],torchelast:[0,1,2,5,6,7,8,9,10],torchelastic_etcd_binary_path:7,torchelastic_max_restart:1,torchelastic_restart_count:1,total:[1,5,7],total_num_epoch:10,track:0,train:[0,1,3,6,7],train_loop:7,train_script:6,train_step:1,trainer:[0,1,2,9],trainer_func:9,trainers_per_nod:6,trainsit:7,tranisiton:7,transit:7,trigger:7,trivial:0,try_create_rendezv:7,ttl:7,tupl:[5,7],two:[2,5],type:[0,7,9],typic:[0,1,9],ultim:9,unblock:7,uncaught:0,underli:0,understand:0,unexpect:7,unhandl:0,unhealthi:0,union:1,uniqu:[0,1,5,7,9],unit:[0,1],unknown:0,unless:9,unrecover:0,until:7,updat:0,upon:0,url:[6,7],usag:[0,1,5,7,9],use:[1,2,5,6,7,8],use_env:10,usecas:2,used:[1,2,5,7,9],useful:[7,9],user:[0,1,5,7,10],uses:[1,5,7,9],using:[0,1,2,5,7,9],usr:7,valid:7,valu:[0,1,5,7],variabl:[1,2,10],variou:8,version:[2,7],via:7,video:2,visibl:5,visit:10,w605:7,wai:5,wait:7,wait_for_fin:7,wait_for_p:7,wait_for_rendezvous_to_fre:7,want:5,well:[1,7],were:10,weren:7,what:5,whatev:9,when:[0,1,2,7,9,10],where:[1,3,7,9],whether:[0,7],which:[0,1,7,9],who:7,whole:2,window:7,with_etcd:[1,2],within:[1,7,9],without:7,word:7,work:[0,1,2,7,8,9,10],worker:[0,1,2,7,9,10],worker_group:0,worker_id:9,workergroup:[0,1],workergroupfailureexcept:0,workerspec:[0,9],workerst:0,workspac:2,world:[0,1,7],world_siz:[0,1,7,10],worst:10,worth:10,would:[2,7],wrap:9,write:[5,6,7],yet:0,you:[0,1,2,5,6,7,8,9,10],your:[1,2,5,6,7,8,9,10],your_training_script:[1,6]},titles:["Elastic Agent","Elastic Launch","Examples","TorchElastic","TorchElastic Kubernetes","Metrics","Quickstart","Rendezvous","Cloud Provider Support (Deprecated)","Expiration Timers","Train script"],titleterms:{AWS:8,agent:0,azur:8,classi:2,client:9,cloud:8,concept:0,contain:2,custom:9,deprec:8,document:3,ec2:8,elast:[0,1],etcd:7,exampl:2,except:7,expir:9,extend:0,handler:[5,7],imagenet:2,implement:[0,9],implment:7,kubernet:4,launch:1,launcher:1,method:[5,9],metric:5,multi:2,node:2,prerequisit:2,provid:8,quickstart:6,rendezv:7,script:10,server:[0,7,9],support:8,timer:9,torchelast:[3,4],train:10,vision:2,write:9}})